<!DOCTYPE html>












  


<html class="theme-next muse use-motion" lang="ko">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
























<link rel="stylesheet" href="https:/cantapiya.github.io/catslab_blog/lib/font-awesome/css/font-awesome.min.css?v=4.6.2">

<link rel="stylesheet" href="https:/cantapiya.github.io/catslab_blog/css/main.css?v=7.1.0">


  <link rel="apple-touch-icon" sizes="180x180" href="https:/cantapiya.github.io/catslab_blog/images/apple-touch-icon-next.png?v=7.1.0">


  <link rel="icon" type="image/png" sizes="32x32" href="https:/cantapiya.github.io/catslab_blog/images/favicon-32x32-next.png?v=7.1.0">


  <link rel="icon" type="image/png" sizes="16x16" href="https:/cantapiya.github.io/catslab_blog/images/favicon-16x16-next.png?v=7.1.0">


  <link rel="mask-icon" href="https:/cantapiya.github.io/catslab_blog/images/logo.svg?v=7.1.0" color="#222">







<script id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: 'https://cantapiya.github.io/catslab_blog/',
    scheme: 'Muse',
    version: '7.1.0',
    sidebar: {"position":"left","display":"post","offset":12,"onmobile":false,"dimmer":false},
    back2top: true,
    back2top_sidebar: false,
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta property="og:type" content="website">
<meta property="og:title" content="CATSLAB BLOG">
<meta property="og:url" content="https://cantapiya.github.io/catslab_blog/page/2/index.html">
<meta property="og:site_name" content="CATSLAB BLOG">
<meta property="og:locale" content="ko">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="CATSLAB BLOG">





  
  
  <link rel="canonical" href="https://cantapiya.github.io/catslab_blog/page/2/">



<script id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>CATSLAB BLOG</title>
  












  <noscript>
  <style>
  .use-motion .motion-element,
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-title { opacity: initial; }

  .use-motion .logo,
  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="ko">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta">
    

    <div class="custom-logo-site-title">
      <a href="https://cantapiya.github.io/catslab_blog/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">CATSLAB BLOG</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
    
      
        <p class="site-subtitle">Descriptions for CATSLAB package and Kubernetes Settings</p>
      
    
    
  </div>

  <div class="site-nav-toggle">
    <button aria-label="Toggle navigation bar">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>



<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        
        
          
          <li class="menu-item menu-item-home">

    
    
    
      
    

    

    <a href="https:/cantapiya.github.io/catslab_blog/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i> <br>홈</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-categories">

    
    
    
      
    

    

    <a href="https:/cantapiya.github.io/catslab_blog/categories/" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i> <br>카테고리</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-archives">

    
    
    
      
    

    

    <a href="https:/cantapiya.github.io/catslab_blog/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i> <br>아카이브</a>

  </li>

      
      
    </ul>
  

  
    

  

  
</nav>



  



</div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://cantapiya.github.io/catslab_bloghttps:/cantapiya.github.io/catslab_blog/2019/02/26/2019-02-25-catslab-trade-order-post/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="bychkim">
      <meta itemprop="description" content>
      <meta itemprop="image" content="https:/cantapiya.github.io/catslab_blog/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="CATSLAB BLOG">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="https:/cantapiya.github.io/catslab_blog/2019/02/26/2019-02-25-catslab-trade-order-post/" class="post-title-link" itemprop="url">A.6 Order 객체 생성 및 사용 예시</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">작성일</span>
              

              
                
              

              <time title="Post created: 2019-02-26 04:48:58" itemprop="dateCreated datePublished" datetime="2019-02-26T04:48:58+09:00">2019-02-26</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Edited on</span>
                
                <time title="Updated at: 2019-02-25 17:58:28" itemprop="dateModified" datetime="2019-02-25T17:58:28+09:00">2019-02-25</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="https:/cantapiya.github.io/catslab_blog/categories/catslab-trade/" itemprop="url" rel="index"><span itemprop="name">catslab trade</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="A-6-Order-객체-생성-및-사용-예시"><a href="#A-6-Order-객체-생성-및-사용-예시" class="headerlink" title="A.6. Order 객체 생성 및 사용 예시"></a>A.6. Order 객체 생성 및 사용 예시</h2><p>거래소에 주문을 전송하기 전에 Order 객체를 생성하여 list에 저장을 한 뒤, 거래소 API를 이용하는 함수를 사용하여 list에 저장되어 있는 주문들을 한 번에 처리합니다.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Order</span><span class="params">(currency, order_type, quantity, price, fiat)</span>:</span></span><br></pre></td></tr></table></figure>
<p><strong>A.6.1. currency (str)</strong><br>거래소에 주문을 넣을 가상 화폐의 명칭을 입력합니다.<br>(예: “btc”, “eth”, “xrp”, … )</p>
<p><strong>A.6.2. order_type (str)</strong><br>매수와 매도를 구분하기 위한 parameter입니다.<br>매수 주문의 경우 “BUY”, 매도 주문의 경우 “SELL” 타입으로 입력합니다.</p>
<p><strong>A.6.3. quantity (float)</strong><br>주문할 가상화폐의 수량을 입력합니다.</p>
<p><strong>A.6.4. price (int)</strong><br>주문할 가상화폐의 가격을 입력합니다.</p>
<p><strong>A.6.5. fiat (str)</strong><br>거래소에서 사용하는 기축화폐를 입력합니다.<br>(예: “krw”, “usd”, … )</p>
<p>Order 객체의 사용 예시는 다음과 같습니다.</p>
<p>매수주문 (현재 가격으로 주문): </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> coza.objects <span class="keyword">import</span> Order</span><br><span class="line"></span><br><span class="line">price = data[f’&#123;currency]_&#123;int(interval)&#125;’][‘close’].loc[data[f’&#123;currency]_&#123;int(interval)&#125;’].index[<span class="number">-1</span>]]</span><br><span class="line">buy_order = Order(currency=’xrp’, order_type=’BUY’, fiat=’krw’, price=price, quantity=<span class="number">1.2345</span>)</span><br></pre></td></tr></table></figure>
<p>매도주문 (지정가 주문):<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> coza.objects <span class="keyword">import</span> Order</span><br><span class="line"></span><br><span class="line">sell_order = Order(currency=’xrp’, order_type=’SELL’, fiat=’krw’, price=<span class="number">342</span>, quantity=<span class="number">5.4321</span>)</span><br></pre></td></tr></table></figure></p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://cantapiya.github.io/catslab_bloghttps:/cantapiya.github.io/catslab_blog/2019/02/26/2019-02-25-catslab-trade-run-strategy-post/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="bychkim">
      <meta itemprop="description" content>
      <meta itemprop="image" content="https:/cantapiya.github.io/catslab_blog/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="CATSLAB BLOG">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="https:/cantapiya.github.io/catslab_blog/2019/02/26/2019-02-25-catslab-trade-run-strategy-post/" class="post-title-link" itemprop="url">A.4 run_strategy 함수 작성 및 예시</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">작성일</span>
              

              
                
              

              <time title="Post created: 2019-02-26 04:15:21" itemprop="dateCreated datePublished" datetime="2019-02-26T04:15:21+09:00">2019-02-26</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Edited on</span>
                
                <time title="Updated at: 2019-02-25 17:57:23" itemprop="dateModified" datetime="2019-02-25T17:57:23+09:00">2019-02-25</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="https:/cantapiya.github.io/catslab_blog/categories/catslab-trade/" itemprop="url" rel="index"><span itemprop="name">catslab trade</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="A-4-run-strategy-함수의-작성-및-사용-예시"><a href="#A-4-run-strategy-함수의-작성-및-사용-예시" class="headerlink" title="A.4. run_strategy 함수의 작성 및 사용 예시"></a>A.4. run_strategy 함수의 작성 및 사용 예시</h2><p>1분 주기로 업데이트 되는 dataframe을 이용하여 사용자가 전략에서 사용하는 기술적 지표 및 매수/매도의 근거가 되는 전략을 계산하고 업데이트하는 함수입니다.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">run_strategy</span><span class="params">(self, is_update, trade_info, update_len, data)</span>:</span></span><br></pre></td></tr></table></figure>
<p><strong>A.4.1. is_update (dict)</strong><br>is_update parameter는 가상화폐와 분봉의 종류에 따라 “{currency}_{interval}” 형태의 key값과, 해당 분봉의 update 여부에 따라 bool 타입의 value값을 갖습니다. </p>
<p>예를 들어, 1분을 주기로 Trade 함수(A.2. 참고)가 진행될 때, 1분마다 생성되는 1분봉의 경우 매분 새롭게 캔들 데이터가 생성되어 dataframe 업데이트가 진행됩니다. </p>
<p>이외의 분봉들은 해당 분봉이 생성되고 나서 dataframe 업데이트의 여부에 따라 bool 타입의 value값이 is_update에 저장됩니다.</p>
<p><strong>A.4.2. trade_info (dict)</strong><br>전략에서 사용하는 거래소, 가상화폐, 분봉의 종류 및 safety setting에 대한 정보를 저장하고 있는 parameter입니다. 초기에 BotContext를 생성할 때 initialize(A.3. 참고)에서 입력한 정보들과 같습니다.</p>
<p><strong>A.4.3. update_len (dict)</strong><br>각각의 가상화폐와 분봉에 따라 1분 주기로 dataframe의 업데이트 여부를 is_update에 저장하는 것과 동시에 업데이트 된 캔들 데이터의 개수가 update_len에 저장됩니다. </p>
<p>is_update와 마찬가지로 “{currency}_{interval}” 형태의 key값을 가지고, 업데이트 된 캔들 데이터의 개수를 value값으로 가집니다. </p>
<p>이 parameter는 실제 거래소에서 캔들 데이터가 생성되더라도 크롤링이나 거래소 API를 이용하여 데이터를 호출하는 과정에서 업데이트 되어야할 캔들 데이터가 누락 또는 지연이 되거나, 거래소 점검으로 인해 업데이트 되는 캔들 데이터가 없는 경우를 구분하기 위해 사용합니다.</p>
<p><strong>A.4.4. data (dict)</strong><br>전략에서 사용하기 위해 입력한 가상화폐의 종류와 분봉의 종류에 따라 “{currency}_{interval}” 형태의 key값과 dataframe을 value값으로 갖는 dictionary입니다. </p>
<p>각 dataframe에는 해당 가상화폐와 분봉의 캔들 데이터 및 전략에서 사용되는 기술적 지표들이 저장되어 있습니다. </p>
<p>또한, 각 분봉마다 가지고 있는 default 개수만큼을 가장 최근에 업데이트 된 캔들 데이터까지 저장하고 있습니다. </p>
<p>각 분봉의 default 개수는 다음과 같습니다.<br>1분봉         : 10080개 (1주일)<br>3분봉         : 3360개 (1주일)<br>5분봉         : 8640개 (1개월)<br>15분봉        : 2880개 (1개월)<br>30분봉        : 1440개 (1개월)<br>60분봉        : 2160개 (3개월)<br>120분봉    : 1080개 (3개월)<br>240분봉    : 540개 (3개월)<br>1440분봉    : 365개 (1년)</p>
<p>run_strategy 함수의 사용 예시는 5일 이동평균선과 20일 이동평균선을 사용하는 전략으로 다음과 같습니다.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> coza.ta <span class="keyword">import</span> candle_slicing</span><br><span class="line"><span class="keyword">from</span> coza.ta <span class="keyword">import</span> ema</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">run_strategy</span><span class="params">(self, is_update, trade_info, update_len, data)</span>:</span></span><br><span class="line">    <span class="keyword">for</span> currency <span class="keyword">in</span> trade_info[<span class="string">'coinone'</span>][<span class="string">'currency'</span>]:</span><br><span class="line">        <span class="keyword">for</span> interval <span class="keyword">in</span> trade_info[<span class="string">'coinone'</span>][<span class="string">'interval'</span>]:</span><br><span class="line">            <span class="keyword">if</span> int(interval) == <span class="number">1</span>:</span><br><span class="line">                <span class="keyword">if</span> len(is_update.keys()) != <span class="number">0</span>:</span><br><span class="line">                    update_number = update_len[<span class="string">f'<span class="subst">&#123;currency&#125;</span>_<span class="subst">&#123;int(interval)&#125;</span>'</span>]</span><br><span class="line"></span><br><span class="line">                    update_candle_20 = \</span><br><span class="line">                    candle_slicing(df=df, n=<span class="number">20</span>, update_number=update_number)</span><br><span class="line">                    update_candle_60 = \</span><br><span class="line">                    candle_slicing(df=df, n=<span class="number">60</span>, update_number=update_number)</span><br><span class="line"></span><br><span class="line">                    update_ema_20 = \</span><br><span class="line">                    ema(update_candle_20[<span class="string">'close'</span>], <span class="number">20</span>).tail(update_number)</span><br><span class="line">                    update_ema_60 = \</span><br><span class="line">                    ema(update_candle_60[<span class="string">'close'</span>], <span class="number">60</span>).tail(update_number)</span><br><span class="line">                    </span><br><span class="line">                    <span class="keyword">if</span> update_number &gt;= <span class="number">1</span>:</span><br><span class="line">                        start_index_20 = update_ema_20.index[<span class="number">0</span>]</span><br><span class="line">                        start_index_60 = update_ema_60.index[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">                        <span class="keyword">for</span> index <span class="keyword">in</span> range(update_number):</span><br><span class="line">                            data[<span class="string">f'<span class="subst">&#123;currency&#125;</span>_<span class="subst">&#123;int(interval)&#125;</span>'</span>].set_value(start_index+timedelta(days=index), <span class="string">'ema_20'</span>, update_ema_20.loc[start_index+timedelta(days=index)])</span><br><span class="line">                            data[<span class="string">f'<span class="subst">&#123;currency&#125;</span>_<span class="subst">&#123;int(interval)&#125;</span>'</span>].set_value(start_index+timedelta(days=index), <span class="string">'ema_60'</span>, update_ema_60.loc[start_index+timedelta(days=index)])</span><br><span class="line">                        </span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    data[<span class="string">f'<span class="subst">&#123;currency&#125;</span>_<span class="subst">&#123;int(interval)&#125;</span>'</span>][<span class="string">'ema_20'</span>] = \</span><br><span class="line">                    ema(data[<span class="string">f'<span class="subst">&#123;currency&#125;</span>_<span class="subst">&#123;int(interval)&#125;</span>'</span>][<span class="string">'close'</span>], <span class="number">20</span>)</span><br><span class="line">                    data[<span class="string">f'<span class="subst">&#123;currency&#125;</span>_<span class="subst">&#123;int(interval)&#125;</span>'</span>][<span class="string">'ema_60'</span>] = \</span><br><span class="line">                    ema(data[<span class="string">f'<span class="subst">&#123;currency&#125;</span>_<span class="subst">&#123;int(interval)&#125;</span>'</span>][<span class="string">'close'</span>], <span class="number">60</span>)</span><br></pre></td></tr></table></figure>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://cantapiya.github.io/catslab_bloghttps:/cantapiya.github.io/catslab_blog/2019/02/26/2019-02-25-catslab-trade-initialize-post/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="bychkim">
      <meta itemprop="description" content>
      <meta itemprop="image" content="https:/cantapiya.github.io/catslab_blog/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="CATSLAB BLOG">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="https:/cantapiya.github.io/catslab_blog/2019/02/26/2019-02-25-catslab-trade-initialize-post/" class="post-title-link" itemprop="url">A.3 Initialze의 작성 및 사용 예시</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">작성일</span>
              

              
                
              

              <time title="Post created: 2019-02-26 03:25:25" itemprop="dateCreated datePublished" datetime="2019-02-26T03:25:25+09:00">2019-02-26</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Edited on</span>
                
                <time title="Updated at: 2019-02-25 19:29:46" itemprop="dateModified" datetime="2019-02-25T19:29:46+09:00">2019-02-25</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="https:/cantapiya.github.io/catslab_blog/categories/catslab-trade/" itemprop="url" rel="index"><span itemprop="name">catslab trade</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><strong>A.3. initialize 함수의 작성 및 사용 예시</strong><br>Initialize 함수의 작성 형식은 다음과 같은 형식을 갖으며,<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">initialize</span><span class="params">(self)</span>:</span></span><br><span class="line">	self.context[‘trade_info’] = &#123;<span class="string">"EXCHANGE_NAME_1"</span>: &#123;</span><br><span class="line">					<span class="string">"currency"</span>: [], </span><br><span class="line">					<span class="string">"interval"</span>: [],</span><br><span class="line">					<span class="string">"fiat"</span>: FIAT</span><br><span class="line">					&#125;,</span><br><span class="line">				<span class="string">"EXCHANGE_NAME_2"</span>: &#123;</span><br><span class="line">					<span class="string">"currency"</span>: [],</span><br><span class="line">					<span class="string">"interval"</span>: [],</span><br><span class="line">					<span class="string">"fiat"</span>: FIAT</span><br><span class="line">					&#125;,</span><br><span class="line">			… , </span><br><span class="line">			</span><br><span class="line">				<span class="string">"safety_setting"</span>: &#123;</span><br><span class="line">					<span class="string">"profit_target"</span>: &#123;</span><br><span class="line">					<span class="string">"checked"</span>: bool,</span><br><span class="line">					<span class="string">"ratio"</span>: RATIO</span><br><span class="line">					&#125;,</span><br><span class="line">				<span class="string">"stop_loss"</span>:&#123;</span><br><span class="line">					<span class="string">"checked"</span>: bool,</span><br><span class="line">					<span class="string">"ratio"</span>: RATIO</span><br><span class="line">					&#125;,</span><br><span class="line">				<span class="string">"stop_on_sell"</span>: bool,</span><br><span class="line">				<span class="string">"trailing_stop"</span>: &#123;</span><br><span class="line">					<span class="string">"checked"</span>: bool,</span><br><span class="line">					<span class="string">"dec_ratio"</span>: RATIO,</span><br><span class="line">					<span class="string">"inc_ratio"</span>: RATIO</span><br><span class="line">					&#125;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br></pre></td></tr></table></figure></p>
<p>실제로 작성한 예제는 다음과 같습니다.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">initialize</span><span class="params">(self)</span>:</span></span><br><span class="line">self.context[<span class="string">'trade_info'</span>] = &#123;<span class="string">"coinone"</span>: &#123;</span><br><span class="line">					<span class="string">"currency"</span>: [<span class="string">"xrp"</span>],</span><br><span class="line">					<span class="string">"interval"</span>: [<span class="number">1</span>],</span><br><span class="line">					<span class="string">"fiat"</span>: <span class="string">"krw"</span></span><br><span class="line">					&#125;, </span><br><span class="line">			<span class="string">"safety_setting"</span>: &#123;</span><br><span class="line">					<span class="string">"profit_target"</span>: &#123;</span><br><span class="line">					<span class="string">"checked"</span>: <span class="literal">True</span>, </span><br><span class="line">					<span class="string">"ratio"</span>: <span class="number">0.10</span>,</span><br><span class="line">						&#125;, </span><br><span class="line">			<span class="string">"stop_loss"</span>: &#123;</span><br><span class="line">					<span class="string">"checked"</span>: <span class="literal">False</span>, </span><br><span class="line">					<span class="string">"ratio"</span>: <span class="number">0.10</span></span><br><span class="line">						&#125;, </span><br><span class="line">			<span class="string">"stop_on_sell"</span>: <span class="literal">True</span>, </span><br><span class="line">			<span class="string">"trailing_stop"</span>: &#123;</span><br><span class="line">					<span class="string">"checked"</span>: <span class="literal">True</span>, </span><br><span class="line">					<span class="string">"dec_ratio"</span>: <span class="number">0.05</span>,</span><br><span class="line">					<span class="string">"inc_ratio"</span>: <span class="number">0.07</span></span><br><span class="line">						&#125;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br></pre></td></tr></table></figure>
<p>각각의 파라미터들은 다음과 같은 속성을 갖습니다.</p>
<p><strong>A.3.1. “EXCHANGE_NAME”: {“currency”: [], “interval”: [], “fiat”: FIAT}</strong><br>Bot에서 사용할 거래소의 명칭 EXCHANGE_NAME을 key로 하여, 해당 거래소에서 사용할 가상화폐(currency)의 종류, 분봉(interval)의 종류, 기축화폐(fiat)의 정보를 dictionary 타입으로 입력합니다. </p>
<p><strong>A.3.1.1. “currency”: []</strong><br>EXCHANGE_NAME을 key값으로 하는 dictionary에서 가상화폐의 종류에 대한 정보는 “currency”를 key, 사용할 가상화폐의 종류가 저장된 list를 value값으로 합니다.<br>(예: “currency”: [“btc”, “xrp”, “eth”])</p>
<p><strong>A.3.1.2. “interval”: []</strong><br>A.2.2와 마찬가지로 사용할 분봉에 대한 정보는 “interval”을 key, 사용할 분봉의 종류가 저장된 list를 value값으로 합니다.<br>(예: “interval”: [1, 5, 60])</p>
<p><strong>A.3.1.3. “fiat”: FIAT</strong><br>거래소에서 사용하는 기축화폐의 정보의 경우 “fiat”를 key값으로 하고, string 타입의 FIAT를 value값으로 가집니다.<br>(예: “fiat”: “krw” 또는 “fiat”: “usd”)</p>
<p><strong>A.3.2. “safety_setting”: {“profit_target”:{}, “stop_loss”:{}, “stop_on_sell”:bool, “trailing_stop”:{}}</strong><br>Bot에서 사용할 safety setting에 대한 정보 역시 “safety_setting”을 key값으로 하는 dictionary 타입으로 입력합니다. </p>
<p><strong>A.3.2.1. “profit_target”: {“checked”: bool, “ratio”: RATIO}</strong><br>Bot에서 사용할 익절 조건(“profit_target”)으로, 초기 투입 금액의 입력한 RATIO 이상으로 수익이 발생했을 시에 자동으로 Bot을 중단시키는 조건입니다. </p>
<p>이 기능을 사용할 것인지에 대한 여부를 “checked”를 key값, bool 타입의 value값으로 입력하고, 익절 조건의 비율을 float 타입의 RATIO (0&lt;=RATIO&lt;=1)로 입력합니다.</p>
<p><strong>A.3.2.2. “stop_loss”: {“checked”: bool, “ratio”: RATIO}</strong><br>Bot에서 사용할 손절 조건(“stop_loss”)으로, 초기 투입 금액의 입력한 RATIO 이하으로 손해가 발생했을 시에 자동으로 Bot을 중단시키는 조건입니다. </p>
<p>이 기능을 사용할 것인지에 대한 여부를 “checked”를 key값, bool 타입의 value값으로 입력하고, 손절 조건의 비율을 float 타입의 RATIO (0&lt;=RATIO&lt;=1)로 입력합니다.</p>
<p><strong>A.3.2.3. “stop_on_sell”: bool</strong><br>safety setting의 조건을 만족하여 거래를 중단할 경우 보유하고 있던 가상화폐들을 청산할 것인지에 대한 여부를 “stop_on_sell”를 key값으로하여 bool 타입의 value를 입력합니다. </p>
<p><strong>A.3.2.4. “trailing_stop”: {“checked”: bool, “dec_ratio”: RATIO, “inc_ratio”: RATIO}</strong><br>Bot을 가동중에 입력한 RATIO(“inc_ratio”) 이상 수익이 발생한 경우, 이후 거래에서 “dec_ratio” 이하로 하락했을 시 Bot 가동을 중단시키는 기능입니다. </p>
<p>기능의 사용 여부를 “checked”를 key값, bool 타입의 value값으로 입력하고, 기능이 발동되는 기준인 상승 조건을 “inc_ratio”의 key값과 float 타입의 RATIO (0&lt;=RATIO&lt;=1)로 입력합니다. 상승 이후 하락 조건을 “dec_ratio”의 key값과 float 타입의 RATIO (0&lt;=RATIO&lt;=1)로 입력합니다. </p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://cantapiya.github.io/catslab_bloghttps:/cantapiya.github.io/catslab_blog/2019/02/26/2019-02-25-catslab-trade-botcontext-post/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="bychkim">
      <meta itemprop="description" content>
      <meta itemprop="image" content="https:/cantapiya.github.io/catslab_blog/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="CATSLAB BLOG">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="https:/cantapiya.github.io/catslab_blog/2019/02/26/2019-02-25-catslab-trade-botcontext-post/" class="post-title-link" itemprop="url">A.1 BotContext의 생성</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">작성일</span>
              

              
                
              

              <time title="Post created: 2019-02-26 00:08:34" itemprop="dateCreated datePublished" datetime="2019-02-26T00:08:34+09:00">2019-02-26</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Edited on</span>
                
                <time title="Updated at: 2019-02-25 19:30:49" itemprop="dateModified" datetime="2019-02-25T19:30:49+09:00">2019-02-25</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="https:/cantapiya.github.io/catslab_blog/categories/catslab-trade-botcontext/" itemprop="url" rel="index"><span itemprop="name">catslab trade botcontext</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="A-1-BotContext의-생성"><a href="#A-1-BotContext의-생성" class="headerlink" title="A.1. BotContext의 생성"></a>A.1. BotContext의 생성</h2><p>BOT_NAME을 지정하여 아래의 parameter를 입력하여 BotContext를 생성할 수 있습니다.<br>생성과 동시에 전략에서 사용할 가상화폐와 분봉들의 dataframe을 로드하여 저장합니다.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">BOT_NAME = BotContext(api_key, </span><br><span class="line">		secret_key, </span><br><span class="line">		init_budget, </span><br><span class="line">		exchange, </span><br><span class="line">		initialize, </span><br><span class="line">		run_strategy, </span><br><span class="line">		make_orders)</span><br></pre></td></tr></table></figure>
<p><strong>A.1.1. api_key (str)</strong><br>거래소로부터 발급 받은 사용자의 거래소 api key를 입력합니다.</p>
<p><strong>A.1.2. secret_key (str)</strong><br>거래소로부터 발급 받은 사용자의 거래소 secret key를 입력합니다.</p>
<p><strong>A.1.3. init_budget (int)</strong><br>사용자의 Bot에서 사용할 자산의 초기 투입 금액을 입력합니다.</p>
<p><strong>A.1.4. exchange (str)</strong><br>Bot에서 가상 화폐 거래를 할 때 이용할 거래소의 명칭을 입력합니다.<br>(해당 거래소에서 발급 받은 api key, secret key를 위의 입력 값으로 사용합니다.) </p>
<p><strong>A.1.5. initialize</strong><br>사용자가 Bot을 생성할 때 전략에서 사용할 가상화폐의 종류, 분봉, 거래소의 기축 화폐에 대한 정보와 safety setting에 대한 정보를 저장하는 함수입니다.</p>
<p>자세한 설명과 작성 예시는 A.3. initialize를 참고하시기 바랍니다.</p>
<p><strong>A.1.6. run_strategy</strong><br>Bot에서 사용하는 전략에서 매수 및 매도를 위해 참고할 기술적 지표를 계산하여 저장하는 함수입니다.<br>자세한 설명과 작성 예시는 A.4. run_strategy를 참고하시기 바랍니다.</p>
<p><strong>A.1.7. make_orders</strong><br>사용자가 정한 방식에 따라 매수주문/매도주문/주문취소 등을 진행하는 함수입니다.<br>자세한 설명과 작성 예시는 A.5. make_orders를 참고하시기 바랍니다.</p>
<p>dataframe에 접근하는 방식은 우선 BotContext를 생성할 때의 BOT_NAME class에서 exchanges로 접근하여 Bot에서 사용하는 거래소별 객체로 접근할 수 있습니다.<br>각 거래소에서 data로 접근하여 ‘{currency}_{interval}’ 형태의  key값으로 가상화폐 별, 분봉 별 dataframe에 접근이 가능합니다.</p>
<p>생성된 dataframe의 형태는 다음과 같습니다.</p>
<p><img src="!--￼1--" alt="My helpful screenshot">{: width=”50%” height=”50%”}<br><img src="!--￼2--" alt="My helpful screenshot">{: width=”50%” height=”50%”}<br><img src="!--￼3--" alt="My helpful screenshot">{: width=”50%” height=”50%”}</p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://cantapiya.github.io/catslab_bloghttps:/cantapiya.github.io/catslab_blog/2019/02/25/2019-02-25-catslab-trade-base-post/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="bychkim">
      <meta itemprop="description" content>
      <meta itemprop="image" content="https:/cantapiya.github.io/catslab_blog/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="CATSLAB BLOG">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="https:/cantapiya.github.io/catslab_blog/2019/02/25/2019-02-25-catslab-trade-base-post/" class="post-title-link" itemprop="url">A.0 Trade 기본</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">작성일</span>
              

              
                
              

              <time title="Post created: 2019-02-25 23:48:59 / Updated at: 17:53:51" itemprop="dateCreated datePublished" datetime="2019-02-25T23:48:59+09:00">2019-02-25</time>
            

            
              

              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="https:/cantapiya.github.io/catslab_blog/categories/catslab-trade/" itemprop="url" rel="index"><span itemprop="name">catslab trade</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="A-0-COZA-package-및-필요한-모듈-및-함수-import"><a href="#A-0-COZA-package-및-필요한-모듈-및-함수-import" class="headerlink" title="A.0. COZA package 및 필요한 모듈 및 함수 import"></a>A.0. COZA package 및 필요한 모듈 및 함수 import</h2><ul>
<li>필수</li>
</ul>
<p>BotContext 생성을 위해 import 합니다.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> coza.bot <span class="keyword">import</span> BotContext</span><br></pre></td></tr></table></figure>
<p>거래소에 주문을 넣기 위한 Order 객체를 import 합니다.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> coza.objects <span class="keyword">import</span> Order</span><br></pre></td></tr></table></figure>
<p>부가적으로 사용할 패키지 내의 객체나 함수 및 전략에서 이용할 TA들을 import 합니다.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> coza.ta <span class="keyword">import</span> (TA_NAME)</span><br></pre></td></tr></table></figure>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://cantapiya.github.io/catslab_bloghttps:/cantapiya.github.io/catslab_blog/2019/02/25/2019-02-25-catslab-trade-run-post/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="bychkim">
      <meta itemprop="description" content>
      <meta itemprop="image" content="https:/cantapiya.github.io/catslab_blog/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="CATSLAB BLOG">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="https:/cantapiya.github.io/catslab_blog/2019/02/25/2019-02-25-catslab-trade-run-post/" class="post-title-link" itemprop="url">A.2 Trade 실행</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">작성일</span>
              

              
                
              

              <time title="Post created: 2019-02-25 15:46:21 / Updated at: 17:55:14" itemprop="dateCreated datePublished" datetime="2019-02-25T15:46:21+09:00">2019-02-25</time>
            

            
              

              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="https:/cantapiya.github.io/catslab_blog/categories/catslab-trade/" itemprop="url" rel="index"><span itemprop="name">catslab trade</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="A-2-Trade-실행"><a href="#A-2-Trade-실행" class="headerlink" title="A.2. Trade 실행"></a>A.2. Trade 실행</h2><p>BotContext로 지정한 BOT_NAME으로 context의 run 함수를 통해 Bot을 실행 시킬 수 있습니다.<br>(예: BOT_NAME.run())</p>
<p>Bot을 실행하게 되면 context를 생성할 때 입력한 정보들과 함수들을 이용하여, 1분 주기로 다음과 같은 과정을 반복합니다.</p>
<p><strong>A.2.1. 현금과 가상화폐 보유량을 업데이트</strong><br>make_orders에서 생성하여 거래소로 전송한 거래 주문의 거래 체결 여부와 취소 여부를 확인하여 자산의 보유 현황을 업데이트하는 과정을 진행합니다.</p>
<p><strong>A.2.2. 현재 자산의 현금가 추정치를 계산</strong><br>업데이트된 보유 자산을 이용하여 현재 자산들의 현금가격 추정치를 계산합니다.  </p>
<p><strong>A.2.3. initialize에서 입력한 safety setting의 조건을 만족하는지의 여부를 검사</strong><br>이전 단계에서 계산한 현금가의 추정치를 이용하여 사용자가 입력한 safety setting 조건의 만족 여부를 검사합니다. </p>
<p>이 단계에서 safety setting의 조건을 만족할 때, 사용자가 지정한 가동 중지의 여부에 따라 Bot의 가동을 중단 시키거나 계속해서 유지하게 됩니다.</p>
<p>아래의 과정은 Bot의 가동을 유지하는 경우에 진행됩니다.</p>
<p><strong>A.2.4. dataframe 업데이트</strong><br>사용자가 전략에 사용하기 위해 입력한 가상화폐와 분봉의 종류에 따라 dataframe 타입으로 캔들 데이터를 저장하는데, 1분 주기로 각 화폐와 각 분봉 별로 새롭게 캔들이 생성되었는지의 여부를 확인하여 dataframe을 업데이트 합니다.</p>
<p><strong>A.2.5. run_strategy 실행</strong><br>캔들 데이터 업데이트의 여부에 따라 전략에서 사용하는 지표를 업데이트 합니다. </p>
<p>새롭게 생성된 캔들 데이터가 존재하는 경우 업데이트 된 기점으로 새롭게 지표를 계산하여 저장합니다.</p>
<p><strong>A.2.6. make_orders 실행</strong><br>사용자가 지정한 과정을 거쳐 매수주문/매도주문/주문취소를 진행하는 함수를 실행합니다. </p>
<p>이 단계에서 생성한 매수주문/매도주문은 set_order 함수를 이용하여 주문내역에 저장하고, set_cancel 함수를 이용하여 기존에 전송한 주문에 대한 주문취소 요청을 진행합니다.</p>
<p><strong>A.2.7. 거래소 API를 이용하여 거래소로의 주문 요청</strong><br>이전 단계인 make_orders에서 생성한 주문들을 거래소 API를 사용하여 거래소로 주문 요청을 진행합니다. </p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://cantapiya.github.io/catslab_bloghttps:/cantapiya.github.io/catslab_blog/2019/02/25/2019-02-25-catslab-trade-make-orders-post/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="bychkim">
      <meta itemprop="description" content>
      <meta itemprop="image" content="https:/cantapiya.github.io/catslab_blog/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="CATSLAB BLOG">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="https:/cantapiya.github.io/catslab_blog/2019/02/25/2019-02-25-catslab-trade-make-orders-post/" class="post-title-link" itemprop="url">A.5 make_orders 함수의 작성 및 예시</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">작성일</span>
              

              
                
              

              <time title="Post created: 2019-02-25 15:44:30 / Updated at: 17:57:43" itemprop="dateCreated datePublished" datetime="2019-02-25T15:44:30+09:00">2019-02-25</time>
            

            
              

              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="https:/cantapiya.github.io/catslab_blog/categories/catslab-trade/" itemprop="url" rel="index"><span itemprop="name">catslab trade</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="A-5-make-orders-함수의-작성-및-예시"><a href="#A-5-make-orders-함수의-작성-및-예시" class="headerlink" title="A.5. make_orders 함수의 작성 및 예시"></a>A.5. make_orders 함수의 작성 및 예시</h2><p>전략에서 사용하는 매수/매도 방식에 따라 매수주문/매도주문/주문취소를 진행합니다. </p>
<p>주문을 생성할 때는 Order 객체를 이용하여 생성하고, 생성한 주문들은 set_order 함수를 이용하여 주문 내역에 저장합니다. </p>
<p>주문 내역에 있는 주문들은 거래소 API를 이용하는 내부 함수를 사용하여 거래소로 전송됩니다. 주문 취소의 경우 set_cancel을 통해 거래소로 전송이 가능합니다.</p>
<p>주문을 생성하는 Order 객체 생성은 A.6.을 참고하시고, 생성한 주문을 거래소에 전송하기 위해 list에 추가하는 set_order 함수는 A.7.을 참고하시기 바랍니다. 또한, 체결 이전의 주문들의 정보를 저장하고 있는 order_list에 대한 내용은 A.8.에서, 주문 취소를 요청하는 set_cancel 함수에 대한 설명과 사용 방법은 A.9.을 참고하시기 바랍니다.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">make_orders</span><span class="params">(self, is_update, trade_info, update_len, data)</span>:</span></span><br></pre></td></tr></table></figure>
<p><strong>A.5.1. is_update (dict)</strong><br>run_strategy 함수의 parameter와 동일합니다.</p>
<p><strong>A.5.2. trade_info (dict)</strong><br>run_strategy 함수의 parameter와 동일합니다.</p>
<p><strong>A.5.3. update_len (dict)</strong><br>run_strategy 함수의 parameter와 동일합니다.</p>
<p><strong>A.5.4. data (dict)</strong><br>run_strategy 함수의 parameter와 동일합니다.</p>
<p>make_orders 함수의 사용 예시는 다음과 같습니다.</p>
<p>다음 예시는 위의 run_strategy를 기반으로 5일 이동평균선이 20일 이동평균선을 상향 돌파하는 순간 매수, 하향 돌파하는 순간 매도하는 전략입니다.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">make_orders</span><span class="params">(self, is_update, trade_info, update_len, data)</span>:</span></span><br><span class="line">    exchange = <span class="string">'coinone'</span></span><br><span class="line">    interval = <span class="number">1</span></span><br><span class="line">    </span><br><span class="line">    total_fiat = self.exchanges[exchange].balance[<span class="string">'fiat'</span>]</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> currency <span class="keyword">in</span> trade_info[<span class="string">'coinone'</span>][<span class="string">'currency'</span>]:</span><br><span class="line">        current_index = data[<span class="string">f'<span class="subst">&#123;currency&#125;</span>_<span class="subst">&#123;int(interval)&#125;</span>'</span>].index[<span class="number">-1</span>]</span><br><span class="line">        t = current_index</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> data[<span class="string">f'<span class="subst">&#123;currency&#125;</span>_<span class="subst">&#123;int(interval)&#125;</span>'</span>][<span class="string">'ema_20'</span>].loc[current_index-timedelta(seconds=<span class="number">60</span>)] \</span><br><span class="line">        &lt; data[<span class="string">f'<span class="subst">&#123;currency&#125;</span>_<span class="subst">&#123;int(interval)&#125;</span>'</span>][<span class="string">'ema_60'</span>].loc[current_index-timedelta(seconds=<span class="number">60</span>)] \</span><br><span class="line">        <span class="keyword">and</span> data[<span class="string">f'<span class="subst">&#123;currency&#125;</span>_<span class="subst">&#123;int(interval)&#125;</span>'</span>][<span class="string">'ema_20'</span>].loc[current_index] \</span><br><span class="line">        &gt; data[<span class="string">f'<span class="subst">&#123;currency&#125;</span>_<span class="subst">&#123;int(interval)&#125;</span>'</span>][<span class="string">'ema_60'</span>].loc[current_index]:</span><br><span class="line">            order_type = <span class="string">'BUY'</span></span><br><span class="line">            price = data[<span class="string">f'<span class="subst">&#123;currency&#125;</span>_<span class="subst">&#123;int(interval)&#125;</span>'</span>][<span class="string">'close'</span>].loc[current_index]</span><br><span class="line">            quantity = math.floor( round (total_fiat*<span class="number">0.5</span> / price * <span class="number">10</span>**<span class="number">4</span>, <span class="number">4</span>) )/(<span class="number">10</span>**<span class="number">4</span>)</span><br><span class="line">            <span class="keyword">if</span> quantity &gt;= <span class="number">1.0</span> <span class="keyword">and</span> price * quantity &lt;= self.exchanges[exchange].balance[<span class="string">'fiat'</span>]:</span><br><span class="line">                o = Order(currency=currency, order_type=order_type, fiat=<span class="string">'krw'</span>, price=price, quantity=quantity)</span><br><span class="line">                self.set_order(exchange=exchange, o=o, t=t)</span><br><span class="line">                </span><br><span class="line">        <span class="keyword">elif</span> data[<span class="string">f'<span class="subst">&#123;currency&#125;</span>_<span class="subst">&#123;int(interval)&#125;</span>'</span>][<span class="string">'ema_20'</span>].loc[current_index-timedelta(seconds=<span class="number">60</span>)] \</span><br><span class="line">        &gt; data[<span class="string">f'<span class="subst">&#123;currency&#125;</span>_<span class="subst">&#123;int(interval)&#125;</span>'</span>][<span class="string">'ema_60'</span>].loc[current_index-timedelta(seconds=<span class="number">60</span>)] \</span><br><span class="line">        <span class="keyword">and</span> data[<span class="string">f'<span class="subst">&#123;currency&#125;</span>_<span class="subst">&#123;int(interval)&#125;</span>'</span>][<span class="string">'ema_20'</span>].loc[current_index] \</span><br><span class="line">        &lt; data[<span class="string">f'<span class="subst">&#123;currency&#125;</span>_<span class="subst">&#123;int(interval)&#125;</span>'</span>][<span class="string">'ema_60'</span>].loc[current_index]:</span><br><span class="line">            order_type = <span class="string">'SELL'</span></span><br><span class="line">            price = data[<span class="string">f'<span class="subst">&#123;currency&#125;</span>_<span class="subst">&#123;int(interval)&#125;</span>'</span>][<span class="string">'close'</span>].loc[current_index]</span><br><span class="line">            quantity = math.floor(round(self.exchanges[exchange].balance[currency][<span class="string">'avail'</span>] * <span class="number">10</span>**<span class="number">4</span>, <span class="number">4</span>))/(<span class="number">10</span>**<span class="number">4</span>)</span><br><span class="line">            <span class="keyword">if</span> quantity &gt;= <span class="number">1.0</span>:</span><br><span class="line">                o = Order(currency=currency, order_type=order_type, fiat=<span class="string">'krw'</span>, price=price, quantity=quantity)</span><br><span class="line">                self.set_order(exchange=exchange, o=o, t=t)</span><br></pre></td></tr></table></figure>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="https:/cantapiya.github.io/catslab_blog/"><i class="fa fa-angle-left" aria-label="이전 페이지"></i></a><a class="page-number" href="https:/cantapiya.github.io/catslab_blog/">1</a><span class="page-number current">2</span>
  </nav>



          </div>
          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <div class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">bychkim</p>
              <div class="site-description motion-element" itemprop="description"></div>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="https:/cantapiya.github.io/catslab_blog/archives/">
                
                    <span class="site-state-item-count">17</span>
                    <span class="site-state-item-name">포스트</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-categories">
                  
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">8</span>
                    <span class="site-state-item-name">카테고리</span>
                  
                </div>
              

              
            </nav>
          

          

          

          

          

          
          

          
            
          
          

        </div>
      </div>

      

      

    </div>
  </aside>
  


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love" id="animate">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">bychkim</span>

  

  
</div>


  <div class="powered-by">Powered by <a href="https://hexo.io" class="theme-link" rel="noopener" target="_blank">Hexo</a> v3.8.0</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme – <a href="https://theme-next.org" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a> v7.1.0</div>




        








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

    

    
  </div>

  

<script>
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>


























  
  <script src="https:/cantapiya.github.io/catslab_blog/lib/jquery/index.js?v=2.1.3"></script>

  
  <script src="https:/cantapiya.github.io/catslab_blog/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script src="https:/cantapiya.github.io/catslab_blog/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>


  


  <script src="https:/cantapiya.github.io/catslab_blog/js/utils.js?v=7.1.0"></script>

  <script src="https:/cantapiya.github.io/catslab_blog/js/motion.js?v=7.1.0"></script>



  
  


  <script src="https:/cantapiya.github.io/catslab_blog/js/schemes/muse.js?v=7.1.0"></script>



  

  


  <script src="https:/cantapiya.github.io/catslab_blog/js/next-boot.js?v=7.1.0"></script>


  

  

  

  



  




  

  

  

  

  

  

  

  

  

  

  

  

  

  

</body>
</html>
